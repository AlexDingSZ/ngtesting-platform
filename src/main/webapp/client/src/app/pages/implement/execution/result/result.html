<div class="execution-result">

  <div *ngIf="!model" class="row module-tips">请选择用例</div>

  <div *ngIf="model" class="row">
    <form [formGroup]="form" (ngSubmit)="save()" class="my-validate-form">
      <div class="form-group row">
        <div class="result-button col-sm-12">
          <button (click)="pass()" type="button" class="btn btn-primary btn-sm">通过</button>
          <button (click)="fail()" type="button" class="btn btn-danger btn-sm">失败</button>
          <button (click)="block()" type="button" class="btn btn-warning btn-sm">阻塞</button>

          <label class="col-form-label form-check-label">
            <input [(ngModel)]="next" formControlName="next" name="next"
                   class="form-check-input form-control-lg" type="checkbox" value="true">同时转到下一个
          </label>

          <button (click)="returnTo()" type="button"
                  class="button-right btn btn-secondary btn-with-icon btn-sm back">
            <i class="ion-backspace"></i>返回
          </button>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-sm-12">
          <field-show (onSave)="saveField($event)" [(model)]="model" [prop]="'name'" [type]="'string'" [required]="true"></field-show>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-sm-12">

          <div class="tabs-container light">
            <div class="tabs">
              <ngb-tabset  (tabChange)="tabChange($event)">
                <ngb-tab id="info">
                  <ng-template ngbTabTitle>信息</ng-template>
                  <ng-template ngbTabContent></ng-template>
                </ngb-tab>
                <ngb-tab id="history">
                  <ng-template ngbTabTitle>历史</ng-template>
                  <ng-template ngbTabContent></ng-template>
                </ngb-tab>
                <ngb-tab id="result">
                  <ng-template ngbTabTitle>结果</ng-template>
                  <ng-template ngbTabContent></ng-template>
                </ngb-tab>
              </ngb-tabset>
            </div>
          </div>

        </div>
      </div>

      <div [class.hidden]="tab != 'info'">

        <div class="row">
          <div class="col-sm-12 property">
          <table class="io">
            <tbody>
              <tr>
                <td style="width: 25%">
                  <div class="label">状态</div>
                  <field-show (onSave)="saveField($event)" [(model)]="model" [prop]="'status'" [type]="'string'" optionsKey="status"
                              [required]="true" [readonly]="true"></field-show>
                </td>

                <td style="width: 25%">
                  <div class="label">类型</div>
                  <field-show (onSave)="saveField($event)" [(model)]="model" [prop]="'type'" [type]="'dropdown'" optionsKey="type"
                              [required]="true"></field-show>
                </td>
                <td style="width: 25%">
                  <div class="label">优先级</div>
                  <field-show (onSave)="saveField($event)" [(model)]="model" [prop]="'priority'" [type]="'dropdown'" optionsKey="priority"
                              [required]="true"></field-show>
                </td>
                <td style="width: 25%">
                  <div class="label">耗时(分钟)</div>
                  <div class="value">
                    <field-show (onSave)="saveField($event)" [(model)]="model" [prop]="'estimate'" [type]="'number'"
                                [required]="true"></field-show>
                  </div>
                </td>
              </tr>
            <tr>
            </tr>
            </tbody>
          </table>
          </div>
      </div>

      <div class="row field-show-container">
        <div class="col-sm-12">
          <field-show (onSave)="saveField($event)" [(model)]="model"
                      [label]="'目标'" [prop]="'objective'" [type]="'string'"></field-show>
        </div>
      </div>

      <div *ngFor="let field of fields;" class="row field-show-container">
        <div class="col-sm-12">
          <field-show (onSave)="saveField($event)" [(model)]="model"
                      [label]="field.label" [prop]="field.myColumn" [type]="field.type"
                      [format]="field.format" [rows]="field.rows" [required]="field.isRequired"></field-show>
        </div>
      </div>

        <div class="tab-steps form-group row">
          <div class="col-sm-12">
            <steps-table [settings]="settings" [source]="model.steps"
                         (upConfirm)="onUpConfirm($event)"
                         (downConfirm)="onDownConfirm($event)"

                         (createConfirm)="onCreateConfirm($event)"
                         (saveConfirm)="onSaveConfirm($event)"
                         (deleteConfirm)="onDeleteConfirm($event)"
            ></steps-table>
          </div>
        </div>
      </div>

      <div [class.hidden]="tab != 'history'" class="tab-summary">
        历史
      </div>

      <div class="form-group row">
        <label class="col-sm-2 col-form-label"></label>
        <div class="col-sm-10">
          <div class="validate-errors">
            <div class="validate-error" *ngFor="let msg of formErrors">
              <div>{{ msg }}</div>
            </div>
          </div>
        </div>
      </div>

    </form>
  </div>

  <form [formGroup]="form" *ngIf="!model" class="row">
    <div class="my-validate-form small-label">
      <div class="form-group row">
        <label class="col-sm-2 col-form-label"></label>
        <div class="col-sm-10">
          <button (click)="returnTo()" type="button"
                  class="button-right btn btn-secondary btn-with-icon btn-sm back">
            <i class="ion-backspace"></i>返回
          </button>
        </div>
      </div>
    </div>
  </form>

</div>
